# 功能介绍 {#concept_ly5_2cg_ffb .concept}

不管是关系型数据库、还是NoSQL数据库，最基础的查询方式都是基于主键去查询。如果需要通过其他属性列去查询，就需要创建索引。为了使阿里云在线数据平台的功能更丰富，我们支持了倒排索引以及其他一些索引：

-   倒排索引：是搜索系统中多种查询能力的基础结构，可以极大优化查询功能。为此，Table Store提供了倒排索引能力，用户为某些属性列建立了倒排索引后，可以基于这些倒排索引实现多字段自由组合的ad-hoc查询。同时也不用担心性别、年龄、枚举等选择性较差的字段问题了。
-   多维空间索引：是一种用于地理位置等多维空间查询的数据结构。一般都用于时空数据场景，可以极大提高空间查询的性能。为此，Table Store提供了多维空间索引。目前基于多维空间索引提供了地理位置的查询能力，包括附近的人、以及矩形、多边形等范围内的点等常见的地理查询，为大数据筛选、车联网和移动应用提供更丰富的一站式数据查询能力。
-   列式正排索引：同时为了更好地支持排序、统计聚合等功能，也提供了列式存储的正排索引。

基于上述三种基础索引能力，多元索引为用户提供下列功能：

## 非主键列的查询 {#section_dps_xw3_kfb .section}

之前的表格存储（Table Store）仅支持按主键列前缀查询数据，不支持非主键列前缀的查询，对用户有较大的使用限制。有了多元索引后，可以支持非主键列的查询。仅需要对要查询的列（Column）建立多元索引（CreateSearchIndex接口），即可通过该列的值查询数据。

## 多字段自由组合查询（Ad-hoc Query） {#section_kc5_1x3_kfb .section}

不管是NoSQL数据库系统，还是关系型数据库系统，都不能很好地支持多字段自由组合查询（ad-hoc query）。比如有一个表有4列，如果没有提前知道查询方式，或者需要支持多个字段的查询，在关系型数据库中可能需要建立7个二级索引。后期如果再增加第5列，那么索引个数可能会超过10个。而在多元索引中，只需要对这4个字段建立索引，同时还支持And、Or、Not等关系符号。

## 地理位置查询（GIS） {#section_bw1_dy3_kfb .section}

在车联网、物联网等位置相关的应用中，地理位置查询是一个极强的需求。比如查询附近的车，多边形范围内的点（电子围栏等）。目前表格存储多元索引提供了地理位置查询功能，用户可以基于此功能实现附近N公里内的车、矩形框或多边形框内的点等基本查询，为用户开发地理位置相关大数据应用提供了极大的便利性。

## 排序 {#section_s4w_hdg_ffb .section}

排序是在线数据的一个常见需求，比如选择最多、最大、最小和最新等条件的数据。Table Store同样提供了强大的排序能力，包括正序、逆序、单条件、多条件等排序功能，为您存储在Table Store中的数据提供全局的多种排序能力。

## 全文检索 {#section_zq1_pdg_ffb .section}

有了倒排索引后，Table Store也提供了分词能力。基于此，用户可以实现全文检索能力。但目前只有数据召回能力，不提供相关性能力。目前提供两种分词方式，单字分词（single\_word）和最大语义分词（max\_word）。

## 模糊查询 {#section_vxm_5dg_ffb .section}

模糊查询是关系型数据库的一个强大功能，基于like语法可以实现很多易用性极高的功能。但是在分布式数据库中（比如HBase）目前仍无法提供模糊查询。现在Table Store提供了模糊查询能力，仅需为该属性列创建倒排索引，便可模糊查询该字段。

## 前缀查询 {#section_hyw_h2g_ffb .section}

有了模糊查询能力后，Table Store也提供了前缀查询功能。

## 嵌套查询 {#section_e2w_j2g_ffb .section}

在线数据中，除了扁平化的单层结构外，还存在一些更复杂的多层结构场景，比如图片标签。假设某个系统中存储了大量图片，每个图片都有多个实体，比如房子、轿车、人等。在每个图片中，这些实体占的位置、空间大小都不同，所以每个实体的价值（score）也不一样。这相当于每个图片都有多个标签，每个标签有一个名字和一个权重分。如果要根据标签中的条件查询，这时候就需要使用到嵌套查询，嵌套查询功能为复杂数据的建模提供了极大的便利性。

## 去重能力 {#section_hjh_r2g_ffb .section}

基于以上的查询功能查询到结构后，有可能某个属性的数据非常多，导致结果多样性比较差。有了去重能力后，可以限制某个属性在一次结果中的最多个数，这样就能获取更好的结果多样性。

## 数据总行数 {#section_el2_w2g_ffb .section}

多元索引每次查询时都会返回这次请求命令中的数据行数。如果指定一个空查询条件，此时所有创建了索引的数据都符合该条件，返回的数据总行数就是表中已创建了索引的数据总行数。如果用户停止写入，且数据都已经创建了索引，则此时返回的数据总行数就是数据表中的总行数。这个功能适用于数据校验，运营等场景。

如果您在使用多元索引（SearchIndex）过程中遇到任何问题，可以通过以下方式联系我们：

-   [阿里云官网控制台提交工单](https://selfservice.console.aliyun.com/ticket/createIndex)
-   表格存储技术交流钉钉群：11789671

